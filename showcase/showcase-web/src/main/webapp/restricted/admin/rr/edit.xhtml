<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<ui:composition>
	<h:form>
		<p:dialog modal="true" header="Rollendefinition"
			onShow="PF('roledefinitionDialog').loadContents();"
			id="roledefinitionDialog" widgetVar="roledefinitionDialog">
			<h:messages escape="false" />
			<h:panelGrid columns="2">
				<h:outputLabel value="Name " />
				<h:inputText value="#{rrBean.currentRole.roleName}" />
			</h:panelGrid>
			<h:panelGrid>
				<h:outputLabel value="Attribute" />
				<p:commandButton value="Neues Attribut anlegen"
					actionListener="#{rrBean.createNewAttribute()}" update="@none"
					ajax="true" process="@this"
					onclick="PF('editCurrentAttribute').show();" />
				<p:dataTable id="roleAttributes"
					value="#{rrBean.currentRole.attributes}" var="attr"
					paginator="false" emptyMessage="Keine Attribute definiert">
					<p:column>
						<f:facet name="header">
							<h:outputText value="Name" />
						</f:facet>
						<h:outputText value="#{attr.attributeName}" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Editieren" />
						</f:facet>
						<p:commandButton value="Edit"
							actionListener="#{rrBean.editCurrentAttribute(attr)}"
							onclick="PF('editCurrentAttribute').show();" />
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Löschen" />
						</f:facet>
						<p:commandButton value="Löschen" update="roleAttributes"
							process="@this"
							actionListener="#{rrBean.deleteCurrentAttribute(attr)}" />
					</p:column>
				</p:dataTable>
			</h:panelGrid>
			<h:panelGrid columns="2">
				<h:commandButton value="Schließen"
					onclick="PF('roledefinitionDialog').hide();" immediate="true" />
				<h:commandButton value="Speichern"
					action="#{rrBean.saveCurrentRole()}" />
			</h:panelGrid>
		</p:dialog>

		<p:dialog id="editCurrentAttribute" widgetVar="editCurrentAttribute"
			header="Attribut definieren" dynamic="true" modal="true">
			<h:panelGrid columns="2">
				<h:outputLabel value="#{messages.label_name}" />
				<h:inputText value="#{rrBean.currentAttribute.attributeName}" />
			</h:panelGrid>
			<h:panelGrid columns="2">
				<p:commandButton value="Abbrechen"
					onclick="PF('editCurrentAttribute').hide();" immediate="true" />
				<p:commandButton value="Speichern"
					actionListener="#{rrBean.saveCurrentAttribute()}"
					update="roleAttributes"
					oncomplete="PF('editCurrentAttribute').hide();" />
			</h:panelGrid>
		</p:dialog>

	</h:form>

</ui:composition>

</html>